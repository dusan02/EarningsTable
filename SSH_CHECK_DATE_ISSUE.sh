#!/bin/bash
# Kontrola prečo sú dátumy 2000-01-01

cd /srv/EarningsTable && echo "═══════════════════════════════════════════════════════════" && echo "KONTROLA: PREČO SÚ DÁTUMY 2000-01-01?" && echo "═══════════════════════════════════════════════════════════" && echo "" && echo "1. Kontrola finnhub_data - reportDate:" && sqlite3 -header -column modules/database/prisma/prod.db "SELECT symbol, date(reportDate) as reportDate, datetime(createdAt, 'localtime') as createdAt, datetime(updatedAt, 'localtime') as updatedAt FROM finnhub_data LIMIT 5;" && echo "" && echo "2. Kontrola final_report - updatedAt:" && sqlite3 -header -column modules/database/prisma/prod.db "SELECT symbol, date(reportDate) as reportDate, date(snapshotDate) as snapshotDate, datetime(updatedAt, 'localtime') as updatedAt, datetime(createdAt, 'localtime') as createdAt FROM final_report LIMIT 5;" && echo "" && echo "3. Kontrola čo vracia Finnhub API (z logov):" && journalctl -u earnings-cron --since "1 hour ago" --no-pager | grep -E "Fetching earnings|Found.*earnings reports|date" | tail -10 || echo "Žiadne relevantné logy" && echo "" && echo "4. Test - manuálne volanie Finnhub API (ak je možné):" && echo "   (Toto by malo ukázať, aký dátum vracia API)" && echo "" && echo "5. Kontrola či sa používa placeholder dátum:" && grep -r "2000-01-01" modules/cron/src/ 2>/dev/null | head -5 || echo "Žiadne explicitné použitie 2000-01-01 v kóde"

